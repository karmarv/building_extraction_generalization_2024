[08/05 09:01:12] detectron2 INFO: Rank of current process: 0. World size: 1
[08/05 09:01:14] detectron2 INFO: Environment info:
-------------------------------  -----------------------------------------------------------------------------------------------------------
sys.platform                     linux
Python                           3.9.19 (main, May  6 2024, 19:43:03) [GCC 11.2.0]
numpy                            1.26.4
detectron2                       0.6 @/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/model/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.6
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.13.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA RTX A6000 (arch=8.6)
Driver version                   515.65.01
CUDA_HOME                        /usr
Pillow                           10.4.0
torchvision                      0.14.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.10.0
-------------------------------  -----------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[08/05 09:01:14] detectron2 INFO: Command line arguments: Namespace(config_file='projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py', resume=False, eval_only=True, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:50153', opts=['train.init_checkpoint=projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth'])
[08/05 09:01:14] detectron2 INFO: Contents of args.config_file=projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py:
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfunctools[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mpartial[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mtorch[39m[38;5;15m.[39m[38;5;15mnn[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mnn[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfvcore[39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mparam_scheduler[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMultiStepParamScheduler[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mL[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15msolver[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mWarmupParamScheduler[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mmodeling[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMViT[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m

[38;5;186m"""[39m
[38;5;186m1. Setup Dataset in COCO format[39m
[38;5;186m"""[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mos[39m
[38;5;15mdata_root[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/[39m[38;5;186m'[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain/train.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_val[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval/val.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest/test.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m

[38;5;15mmodel[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/models/mask_rcnn_fpn.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mmodel[39m
[38;5;15mconstants[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/data/constants.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mconstants[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_mean[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_mean[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_std[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_std[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15minput_format[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mRGB[39m[38;5;186m"[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15mbottom_up[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMViT[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15membed_dim[39m[38;5;204m=[39m[38;5;141m96[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdepth[39m[38;5;204m=[39m[38;5;141m10[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_heads[39m[38;5;204m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mlast_block_indexes[39m[38;5;204m=[39m[38;5;15m([39m[38;5;141m0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m2[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m7[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m9[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mresidual_pooling[39m[38;5;204m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdrop_path_rate[39m[38;5;204m=[39m[38;5;141m0.2[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnorm_layer[39m[38;5;204m=[39m[38;5;15mpartial[39m[38;5;15m([39m[38;5;15mnn[39m[38;5;204m.[39m[38;5;15mLayerNorm[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15meps[39m[38;5;204m=[39m[38;5;141m1e-6[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mout_features[39m[38;5;204m=[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mscale2[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale3[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale4[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale5[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15min_features[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m$[39m[38;5;186m{[39m[38;5;186m.bottom_up.out_features}[39m[38;5;186m"[39m


[38;5;245m# Initialization and trainer settings[39m
[38;5;15mtrain[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/train.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mtrain[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mamp[39m[38;5;204m.[39m[38;5;15menabled[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mddp[39m[38;5;204m.[39m[38;5;15mfp16_compression[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_T_in1k.pyth[39m[38;5;186m"[39m


[38;5;245m# Data loaders[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m  [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m      [39m[38;5;245m# "beg_val"  # Changed for test report submission[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mtotal_batch_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m8[39m



[38;5;245m# 36 epochs[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m67500[39m
[38;5;15mlr_multiplier[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mWarmupParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mscheduler[39m[38;5;204m=[39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMultiStepParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mvalues[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mmilestones[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m52500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m62500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m67500[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_length[39m[38;5;204m=[39m[38;5;141m250[39m[38;5;15m [39m[38;5;204m/[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_factor[39m[38;5;204m=[39m[38;5;141m0.001[39m[38;5;15m,[39m
[38;5;15m)[39m

[38;5;15moptimizer[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/optim.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mAdamW[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mparams[39m[38;5;204m.[39m[38;5;15moverrides[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15m{[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mpos_embed[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_h[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_w[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m}[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mlr[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m1.6e-4[39m

[08/05 09:01:14] detectron2 INFO: Full config saved to ./output/config.yaml
[08/05 09:01:14] d2.utils.env INFO: Using a generated random seed 16291491
[08/05 09:01:21] d2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:01:21] fvcore.common.checkpoint INFO: [Checkpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:01:22] d2.data.datasets.coco WARNING: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[08/05 09:01:22] d2.data.datasets.coco INFO: Loaded 1000 images in COCO format from /home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/test/test.json
[08/05 09:01:22] d2.data.build INFO: Distribution of instances among all 1 categories:
[36m|  category  | #instances   |
|:----------:|:-------------|
|  building  | 0            |
|            |              |[0m
[08/05 09:01:22] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333)]
[08/05 09:01:22] d2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[08/05 09:01:22] d2.data.common INFO: Serializing 1000 elements to byte tensors and concatenating them all ...
[08/05 09:01:22] d2.data.common INFO: Serialized dataset takes 0.18 MiB
[08/05 09:03:16] detectron2 INFO: Rank of current process: 0. World size: 1
[08/05 09:03:19] detectron2 INFO: Environment info:
-------------------------------  -----------------------------------------------------------------------------------------------------------
sys.platform                     linux
Python                           3.9.19 (main, May  6 2024, 19:43:03) [GCC 11.2.0]
numpy                            1.26.4
detectron2                       0.6 @/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/model/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.6
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.13.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA RTX A6000 (arch=8.6)
Driver version                   515.65.01
CUDA_HOME                        /usr
Pillow                           10.4.0
torchvision                      0.14.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.10.0
-------------------------------  -----------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[08/05 09:03:19] detectron2 INFO: Command line arguments: Namespace(config_file='projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py', resume=False, eval_only=True, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:50153', opts=['train.init_checkpoint=projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth'])
[08/05 09:03:19] detectron2 INFO: Contents of args.config_file=projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py:
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfunctools[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mpartial[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mtorch[39m[38;5;15m.[39m[38;5;15mnn[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mnn[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfvcore[39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mparam_scheduler[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMultiStepParamScheduler[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mL[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15msolver[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mWarmupParamScheduler[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mmodeling[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMViT[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m

[38;5;186m"""[39m
[38;5;186m1. Setup Dataset in COCO format[39m
[38;5;186m"""[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mos[39m
[38;5;15mdata_root[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/[39m[38;5;186m'[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain/train.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_val[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval/val.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest/test.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m

[38;5;15mmodel[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/models/mask_rcnn_fpn.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mmodel[39m
[38;5;15mconstants[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/data/constants.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mconstants[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_mean[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_mean[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_std[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_std[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15minput_format[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mRGB[39m[38;5;186m"[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15mbottom_up[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMViT[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15membed_dim[39m[38;5;204m=[39m[38;5;141m96[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdepth[39m[38;5;204m=[39m[38;5;141m10[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_heads[39m[38;5;204m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mlast_block_indexes[39m[38;5;204m=[39m[38;5;15m([39m[38;5;141m0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m2[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m7[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m9[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mresidual_pooling[39m[38;5;204m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdrop_path_rate[39m[38;5;204m=[39m[38;5;141m0.2[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnorm_layer[39m[38;5;204m=[39m[38;5;15mpartial[39m[38;5;15m([39m[38;5;15mnn[39m[38;5;204m.[39m[38;5;15mLayerNorm[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15meps[39m[38;5;204m=[39m[38;5;141m1e-6[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mout_features[39m[38;5;204m=[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mscale2[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale3[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale4[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale5[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15min_features[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m$[39m[38;5;186m{[39m[38;5;186m.bottom_up.out_features}[39m[38;5;186m"[39m


[38;5;245m# Initialization and trainer settings[39m
[38;5;15mtrain[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/train.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mtrain[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mamp[39m[38;5;204m.[39m[38;5;15menabled[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mddp[39m[38;5;204m.[39m[38;5;15mfp16_compression[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_T_in1k.pyth[39m[38;5;186m"[39m


[38;5;245m# Data loaders[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m  [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m      [39m[38;5;245m# "beg_val"  # Changed for test report submission[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mtotal_batch_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m8[39m



[38;5;245m# 36 epochs[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m67500[39m
[38;5;15mlr_multiplier[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mWarmupParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mscheduler[39m[38;5;204m=[39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMultiStepParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mvalues[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mmilestones[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m52500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m62500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m67500[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_length[39m[38;5;204m=[39m[38;5;141m250[39m[38;5;15m [39m[38;5;204m/[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_factor[39m[38;5;204m=[39m[38;5;141m0.001[39m[38;5;15m,[39m
[38;5;15m)[39m

[38;5;15moptimizer[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/optim.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mAdamW[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mparams[39m[38;5;204m.[39m[38;5;15moverrides[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15m{[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mpos_embed[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_h[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_w[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m}[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mlr[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m1.6e-4[39m

[08/05 09:03:19] detectron2 INFO: Full config saved to ./output/config.yaml
[08/05 09:03:19] d2.utils.env INFO: Using a generated random seed 21519118
[08/05 09:03:28] d2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:03:28] fvcore.common.checkpoint INFO: [Checkpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:03:28] d2.data.datasets.coco WARNING: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[08/05 09:03:28] d2.data.datasets.coco INFO: Loaded 1000 images in COCO format from /home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/test/test.json
[08/05 09:03:28] d2.data.build INFO: Distribution of instances among all 1 categories:
[36m|  category  | #instances   |
|:----------:|:-------------|
|  building  | 0            |
|            |              |[0m
[08/05 09:03:28] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333)]
[08/05 09:03:28] d2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[08/05 09:03:28] d2.data.common INFO: Serializing 1000 elements to byte tensors and concatenating them all ...
[08/05 09:03:28] d2.data.common INFO: Serialized dataset takes 0.18 MiB
[08/05 09:06:17] detectron2 INFO: Rank of current process: 0. World size: 1
[08/05 09:06:19] detectron2 INFO: Environment info:
-------------------------------  -----------------------------------------------------------------------------------------------------------
sys.platform                     linux
Python                           3.9.19 (main, May  6 2024, 19:43:03) [GCC 11.2.0]
numpy                            1.26.4
detectron2                       0.6 @/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/model/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.6
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.13.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA RTX A6000 (arch=8.6)
Driver version                   515.65.01
CUDA_HOME                        /usr
Pillow                           10.4.0
torchvision                      0.14.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.10.0
-------------------------------  -----------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[08/05 09:06:19] detectron2 INFO: Command line arguments: Namespace(config_file='projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py', resume=False, eval_only=True, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:50153', opts=['train.init_checkpoint=projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth'])
[08/05 09:06:19] detectron2 INFO: Contents of args.config_file=projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py:
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfunctools[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mpartial[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mtorch[39m[38;5;15m.[39m[38;5;15mnn[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mnn[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfvcore[39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mparam_scheduler[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMultiStepParamScheduler[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mL[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15msolver[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mWarmupParamScheduler[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mmodeling[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMViT[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m

[38;5;186m"""[39m
[38;5;186m1. Setup Dataset in COCO format[39m
[38;5;186m"""[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mos[39m
[38;5;15mdata_root[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/[39m[38;5;186m'[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain/train.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_val[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval/val.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest/test.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m

[38;5;15mmodel[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/models/mask_rcnn_fpn.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mmodel[39m
[38;5;15mconstants[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/data/constants.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mconstants[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_mean[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_mean[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_std[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_std[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15minput_format[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mRGB[39m[38;5;186m"[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15mbottom_up[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMViT[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15membed_dim[39m[38;5;204m=[39m[38;5;141m96[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdepth[39m[38;5;204m=[39m[38;5;141m10[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_heads[39m[38;5;204m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mlast_block_indexes[39m[38;5;204m=[39m[38;5;15m([39m[38;5;141m0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m2[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m7[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m9[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mresidual_pooling[39m[38;5;204m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdrop_path_rate[39m[38;5;204m=[39m[38;5;141m0.2[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnorm_layer[39m[38;5;204m=[39m[38;5;15mpartial[39m[38;5;15m([39m[38;5;15mnn[39m[38;5;204m.[39m[38;5;15mLayerNorm[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15meps[39m[38;5;204m=[39m[38;5;141m1e-6[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mout_features[39m[38;5;204m=[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mscale2[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale3[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale4[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale5[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15min_features[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m$[39m[38;5;186m{[39m[38;5;186m.bottom_up.out_features}[39m[38;5;186m"[39m


[38;5;245m# Initialization and trainer settings[39m
[38;5;15mtrain[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/train.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mtrain[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mamp[39m[38;5;204m.[39m[38;5;15menabled[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mddp[39m[38;5;204m.[39m[38;5;15mfp16_compression[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_T_in1k.pyth[39m[38;5;186m"[39m


[38;5;245m# Data loaders[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m  [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m      [39m[38;5;245m# "beg_val"  # Changed for test report submission[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mtotal_batch_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m8[39m



[38;5;245m# 36 epochs[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m67500[39m
[38;5;15mlr_multiplier[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mWarmupParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mscheduler[39m[38;5;204m=[39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMultiStepParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mvalues[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mmilestones[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m52500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m62500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m67500[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_length[39m[38;5;204m=[39m[38;5;141m250[39m[38;5;15m [39m[38;5;204m/[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_factor[39m[38;5;204m=[39m[38;5;141m0.001[39m[38;5;15m,[39m
[38;5;15m)[39m

[38;5;15moptimizer[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/optim.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mAdamW[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mparams[39m[38;5;204m.[39m[38;5;15moverrides[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15m{[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mpos_embed[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_h[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_w[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m}[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mlr[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m1.6e-4[39m

[08/05 09:06:19] detectron2 INFO: Full config saved to ./output/config.yaml
[08/05 09:06:19] d2.utils.env INFO: Using a generated random seed 20957718
[08/05 09:06:27] d2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:06:27] fvcore.common.checkpoint INFO: [Checkpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:06:28] d2.data.datasets.coco WARNING: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[08/05 09:06:28] d2.data.datasets.coco INFO: Loaded 1000 images in COCO format from /home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/test/test.json
[08/05 09:06:28] d2.data.build INFO: Distribution of instances among all 1 categories:
[36m|  category  | #instances   |
|:----------:|:-------------|
|  building  | 0            |
|            |              |[0m
[08/05 09:06:28] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333)]
[08/05 09:06:28] d2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[08/05 09:06:28] d2.data.common INFO: Serializing 1000 elements to byte tensors and concatenating them all ...
[08/05 09:06:28] d2.data.common INFO: Serialized dataset takes 0.18 MiB
[08/05 09:10:30] detectron2 INFO: Rank of current process: 0. World size: 1
[08/05 09:10:32] detectron2 INFO: Environment info:
-------------------------------  -----------------------------------------------------------------------------------------------------------
sys.platform                     linux
Python                           3.9.19 (main, May  6 2024, 19:43:03) [GCC 11.2.0]
numpy                            1.26.4
detectron2                       0.6 @/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/model/detectron2/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.6
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          1.13.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0                            NVIDIA RTX A6000 (arch=8.6)
Driver version                   515.65.01
CUDA_HOME                        /usr
Pillow                           10.4.0
torchvision                      0.14.1+cu116 @/home/rahul/miniconda/envs/segm/lib/python3.9/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.10.0
-------------------------------  -----------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.6
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.3.2  (built against CUDA 11.5)
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.6, CUDNN_VERSION=8.3.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

[08/05 09:10:32] detectron2 INFO: Command line arguments: Namespace(config_file='projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py', resume=False, eval_only=True, num_gpus=1, num_machines=1, machine_rank=0, dist_url='tcp://127.0.0.1:50153', opts=['train.init_checkpoint=projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth'])
[08/05 09:10:32] detectron2 INFO: Contents of args.config_file=projects/MViTv2/configs/mask_rcnn_mvitv2_t_3x_beg.py:
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfunctools[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mpartial[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mtorch[39m[38;5;15m.[39m[38;5;15mnn[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mnn[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mfvcore[39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mparam_scheduler[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMultiStepParamScheduler[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mconfig[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mLazyCall[39m[38;5;15m [39m[38;5;81mas[39m[38;5;15m [39m[38;5;15mL[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15msolver[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mWarmupParamScheduler[39m
[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mmodeling[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mMViT[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15m.[39m[38;5;15mcommon[39m[38;5;15m.[39m[38;5;15mcoco_loader[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mdataloader[39m

[38;5;186m"""[39m
[38;5;186m1. Setup Dataset in COCO format[39m
[38;5;186m"""[39m
[38;5;204mimport[39m[38;5;15m [39m[38;5;15mos[39m
[38;5;15mdata_root[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m'[39m[38;5;186m/home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/[39m[38;5;186m'[39m

[38;5;204mfrom[39m[38;5;15m [39m[38;5;15mdetectron2[39m[38;5;15m.[39m[38;5;15mdata[39m[38;5;15m.[39m[38;5;15mdatasets[39m[38;5;15m [39m[38;5;204mimport[39m[38;5;15m [39m[38;5;15mregister_coco_instances[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain/train.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtrain[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_val[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval/val.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mval[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m
[38;5;15mregister_coco_instances[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15m{[39m[38;5;15m}[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest/test.json[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m[38;5;15m [39m
[38;5;15m                                            [39m[38;5;15mos[39m[38;5;204m.[39m[38;5;15mpath[39m[38;5;204m.[39m[38;5;15mjoin[39m[38;5;15m([39m[38;5;15mdata_root[39m[38;5;15m,[39m[38;5;186m"[39m[38;5;186mtest[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m)[39m

[38;5;15mmodel[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/models/mask_rcnn_fpn.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mmodel[39m
[38;5;15mconstants[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/data/constants.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mconstants[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_mean[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_mean[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mpixel_std[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mconstants[39m[38;5;204m.[39m[38;5;15mimagenet_rgb256_std[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15minput_format[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mRGB[39m[38;5;186m"[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15mbottom_up[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMViT[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15membed_dim[39m[38;5;204m=[39m[38;5;141m96[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdepth[39m[38;5;204m=[39m[38;5;141m10[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnum_heads[39m[38;5;204m=[39m[38;5;141m1[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mlast_block_indexes[39m[38;5;204m=[39m[38;5;15m([39m[38;5;141m0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m2[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m7[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m9[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mresidual_pooling[39m[38;5;204m=[39m[38;5;81mTrue[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mdrop_path_rate[39m[38;5;204m=[39m[38;5;141m0.2[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mnorm_layer[39m[38;5;204m=[39m[38;5;15mpartial[39m[38;5;15m([39m[38;5;15mnn[39m[38;5;204m.[39m[38;5;15mLayerNorm[39m[38;5;15m,[39m[38;5;15m [39m[38;5;15meps[39m[38;5;204m=[39m[38;5;141m1e-6[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mout_features[39m[38;5;204m=[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mscale2[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale3[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale4[39m[38;5;186m"[39m[38;5;15m,[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mscale5[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m)[39m
[38;5;15mmodel[39m[38;5;204m.[39m[38;5;15mbackbone[39m[38;5;204m.[39m[38;5;15min_features[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186m$[39m[38;5;186m{[39m[38;5;186m.bottom_up.out_features}[39m[38;5;186m"[39m


[38;5;245m# Initialization and trainer settings[39m
[38;5;15mtrain[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/train.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mtrain[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mamp[39m[38;5;204m.[39m[38;5;15menabled[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mddp[39m[38;5;204m.[39m[38;5;15mfp16_compression[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;81mTrue[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15minit_checkpoint[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mdetectron2://ImageNetPretrained/mvitv2/MViTv2_T_in1k.pyth[39m[38;5;186m"[39m


[38;5;245m# Data loaders[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_train[39m[38;5;186m"[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtest[39m[38;5;204m.[39m[38;5;15mdataset[39m[38;5;204m.[39m[38;5;15mnames[39m[38;5;15m  [39m[38;5;204m=[39m[38;5;15m [39m[38;5;186m"[39m[38;5;186mbeg_test[39m[38;5;186m"[39m[38;5;15m      [39m[38;5;245m# "beg_val"  # Changed for test report submission[39m
[38;5;15mdataloader[39m[38;5;204m.[39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mtotal_batch_size[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m8[39m



[38;5;245m# 36 epochs[39m
[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m67500[39m
[38;5;15mlr_multiplier[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mWarmupParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m    [39m[38;5;15mscheduler[39m[38;5;204m=[39m[38;5;15mL[39m[38;5;15m([39m[38;5;15mMultiStepParamScheduler[39m[38;5;15m)[39m[38;5;15m([39m
[38;5;15m        [39m[38;5;15mvalues[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m1.0[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.1[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m0.01[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m        [39m[38;5;15mmilestones[39m[38;5;204m=[39m[38;5;15m[[39m[38;5;141m52500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m62500[39m[38;5;15m,[39m[38;5;15m [39m[38;5;141m67500[39m[38;5;15m][39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15m)[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_length[39m[38;5;204m=[39m[38;5;141m250[39m[38;5;15m [39m[38;5;204m/[39m[38;5;15m [39m[38;5;15mtrain[39m[38;5;204m.[39m[38;5;15mmax_iter[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;15mwarmup_factor[39m[38;5;204m=[39m[38;5;141m0.001[39m[38;5;15m,[39m
[38;5;15m)[39m

[38;5;15moptimizer[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15mmodel_zoo[39m[38;5;204m.[39m[38;5;15mget_config[39m[38;5;15m([39m[38;5;186m"[39m[38;5;186mcommon/optim.py[39m[38;5;186m"[39m[38;5;15m)[39m[38;5;204m.[39m[38;5;15mAdamW[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mparams[39m[38;5;204m.[39m[38;5;15moverrides[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;15m{[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mpos_embed[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_h[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m    [39m[38;5;186m"[39m[38;5;186mrel_pos_w[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;15m{[39m[38;5;186m"[39m[38;5;186mweight_decay[39m[38;5;186m"[39m[38;5;15m:[39m[38;5;15m [39m[38;5;141m0.0[39m[38;5;15m}[39m[38;5;15m,[39m
[38;5;15m}[39m
[38;5;15moptimizer[39m[38;5;204m.[39m[38;5;15mlr[39m[38;5;15m [39m[38;5;204m=[39m[38;5;15m [39m[38;5;141m1.6e-4[39m

[08/05 09:10:32] detectron2 INFO: Full config saved to ./output/config.yaml
[08/05 09:10:32] d2.utils.env INFO: Using a generated random seed 33987318
[08/05 09:10:39] d2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:10:39] fvcore.common.checkpoint INFO: [Checkpointer] Loading from projects/MViTv2/output_mask_rcnn_mvitv2_t_3x_beg_b8/model_final.pth ...
[08/05 09:10:40] d2.data.datasets.coco WARNING: 
Category ids in annotations are not in [1, #categories]! We'll apply a mapping for you.

[08/05 09:10:40] d2.data.datasets.coco INFO: Loaded 1000 images in COCO format from /home/rahul/workspace/vision/beg24/building_extraction_generalization_2024/dataset/coco/test/test.json
[08/05 09:10:40] d2.data.build INFO: Distribution of instances among all 1 categories:
[36m|  category  | #instances   |
|:----------:|:-------------|
|  building  | 0            |
|            |              |[0m
[08/05 09:10:40] d2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333)]
[08/05 09:10:40] d2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[08/05 09:10:40] d2.data.common INFO: Serializing 1000 elements to byte tensors and concatenating them all ...
[08/05 09:10:40] d2.data.common INFO: Serialized dataset takes 0.18 MiB
